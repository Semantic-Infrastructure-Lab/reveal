# MySQL Health Check Configuration
#
# Copy this file to one of these locations to customize thresholds:
#   ~/.config/reveal/mysql-health-checks.yaml  (user-specific)
#   /etc/reveal/mysql-health-checks.yaml       (system-wide)
#
# If no config file exists, reveal uses the defaults shown below.

checks:
  # Table Scan Ratio: Percentage of SELECT queries without indexes
  # High ratio indicates missing indexes or poorly structured queries
  - name: "Table Scan Ratio"
    metric: "table_scan_ratio"
    pass_threshold: 10     # <10% is excellent
    warn_threshold: 25     # 10-25% is acceptable
    severity: high         # >=25% is a problem
    operator: "<"

  # Thread Cache Miss Rate: Percentage of connections created vs reused
  # High rate means thread_cache_size is too small
  - name: "Thread Cache Miss Rate"
    metric: "thread_cache_miss_rate"
    pass_threshold: 10
    warn_threshold: 25
    severity: medium
    operator: "<"

  # Temp Disk Ratio: Percentage of temp tables created on disk vs memory
  # High ratio indicates tmp_table_size or max_heap_table_size too small
  - name: "Temp Disk Ratio"
    metric: "temp_disk_ratio"
    pass_threshold: 25
    warn_threshold: 50
    severity: medium
    operator: "<"

  # Max Used Connections: Peak connection usage as % of max_connections
  # High percentage indicates you're close to connection limit
  - name: "Max Used Connections %"
    metric: "max_used_connections_pct"
    pass_threshold: 80     # <80% is safe
    warn_threshold: 100    # 80-100% is concerning
    severity: critical     # >=100% means you hit the limit
    operator: "<"

  # Open Files: Current open files as % of open_files_limit
  # Hitting this limit causes "Too many open files" errors
  - name: "Open Files %"
    metric: "open_files_pct"
    pass_threshold: 75
    warn_threshold: 90
    severity: critical
    operator: "<"

  # Current Connections: Active connections as % of max_connections
  # Different from Max Used - this is current, not peak
  - name: "Current Connection %"
    metric: "connection_pct"
    pass_threshold: 80
    warn_threshold: 95
    severity: high
    operator: "<"

  # Buffer Hit Rate: InnoDB buffer pool efficiency
  # >99% means most reads from memory, not disk (good!)
  - name: "Buffer Hit Rate"
    metric: "buffer_hit_rate"
    pass_threshold: 99     # >99% is excellent
    warn_threshold: 95     # >95% is acceptable
    severity: high         # <=95% needs attention
    operator: ">"          # Note: > operator (higher is better)

# Customization Examples:
#
# Stricter thresholds for production:
#   - pass_threshold: 5   # instead of 10
#   - warn_threshold: 15  # instead of 25
#
# More permissive for development:
#   - pass_threshold: 20  # instead of 10
#   - warn_threshold: 50  # instead of 25
#
# Disable a check by removing it from the list
# Add custom checks (if you add new metrics to the adapter):
#   - name: "My Custom Metric"
#     metric: "my_metric_name"
#     pass_threshold: 100
#     warn_threshold: 200
#     severity: low
#     operator: "<"
