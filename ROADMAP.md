# Reveal Roadmap
> **Last updated**: 2026-02-27 (aqua-shade-0227 ‚Äî v0.54.3 release)

This document outlines reveal's development priorities and future direction. For contribution opportunities, see [CONTRIBUTING.md](CONTRIBUTING.md).

---

## What We've Shipped

### v0.54.3
- ‚úÖ **B3 ‚Äî N004 quoted path messages** ‚Äî `.strip('"\'')` on ACME root in N004 messages; cPanel configs quote root directives, causing `'"/home/..."'` double-wrapped display and false-positive path mismatches. Messages now show bare paths; quoted and unquoted forms treated as equal.
- ‚úÖ **U6 ‚Äî `cpanel://USERNAME/ssl --dns-verified`** ‚Äî DNS-verified mode for cpanel ssl: NXDOMAIN domains shown with `[nxdomain]` tag but excluded from critical/expiring summary counts. Eliminates false alarms from former-customer domains whose DNS has moved away. NXDOMAIN-only scope via `socket.getaddrinfo` (stdlib, no subprocess).
- ‚úÖ **Dogfood false positive elimination** ‚Äî three rules fixed via `reveal reveal/ --check`: I001 skips `__init__.py` (imports are always public API/registration); B006 checks enclosing function docstring for error-tolerance keywords before flagging intentional broad catches; V023 skips dispatcher methods (`return self._` delegation pattern).
- ‚úÖ **CPANEL_ADAPTER_GUIDE.md** ‚Äî new comprehensive guide for the cpanel:// adapter.
- ‚úÖ **NGINX_ANALYZER_GUIDE.md** ‚Äî new comprehensive guide for nginx analysis: all flags, N001‚ÄìN006 rules, operator workflows.

### v0.54.2
- ‚úÖ **B1 fix ‚Äî `--validate-nginx-acme` ACL column** ‚Äî `_parse_location_root`/`_parse_server_root` now strip quotes from root paths; cPanel configs quote all `root` directives, causing every domain to report `not_found`. Feature fully functional on production gateways.
- ‚úÖ **`--validate-nginx-acme --only-failures`** ‚Äî filter flag respected; passing rows suppressed; "‚úÖ No failures found." when all pass.
- ‚úÖ **cpanel graduated üî¥ Experimental ‚Üí üü° Beta** ‚Äî accurate production results (3 denied domains found in 2s); B1 was in nginx analyzer, not cpanel.
- ‚úÖ **U1 ‚Äî plain file paths in cpanel next_steps** ‚Äî replaced `nginx:///path` (fragile, subprocess-incompatible) with `reveal /path/file.conf`.
- ‚úÖ **U4 ‚Äî ACL method guidance** ‚Äî added note to `help://cpanel`: filesystem ACL (authoritative) vs nginx ACME audit (routing) ‚Äî explains when to use each.

### v0.54.0
- ‚úÖ **cpanel:// adapter** ‚Äî first-class cPanel user environment adapter: `reveal cpanel://USERNAME` (overview), `/domains` (all docroots), `/ssl` (disk cert health), `/acl-check` (nobody ACL). All filesystem-based; no WHM API needed.
- ‚úÖ **nginx: S4 ‚Äî `--cpanel-certs`** ‚Äî disk cert vs live cert comparison per SSL domain; detects "AutoSSL renewed but nginx not reloaded" (`‚ö†Ô∏è STALE (reload nginx)`). Exit 2 on stale or expired.
- ‚úÖ **nginx: S3 ‚Äî `--diagnose`** ‚Äî scans last 5,000 lines of nginx error log for ACME/SSL failures by domain; groups `permission_denied`, `ssl_error`, `not_found`; exit 2 on first two.
- ‚úÖ **nginx: N1 ‚Äî `--check-acl`** ‚Äî checks nobody-user has read+execute on every `root` directive; exits 2 on any failure.
- ‚úÖ **nginx: N4 ‚Äî `--extract acme-roots`** ‚Äî ACME root paths + nobody ACL status table across all SSL domains.
- ‚úÖ **nginx: N2 ‚Äî `--check-conflicts`** ‚Äî detects prefix overlap and regex-shadows-prefix location routing issues; exit 2 on regex conflicts.
- ‚úÖ **nginx: N3 ‚Äî `--domain` filter** ‚Äî filter any nginx output to a single domain's server block(s).
- ‚úÖ **nginx: `--validate-nginx-acme`** ‚Äî composed audit: ACME root path + ACL + live SSL per domain in one table.
- ‚úÖ **ssl: S2 ‚Äî `ssl://file:///path`** ‚Äî inspect on-disk PEM/DER certs without a network connection.
- ‚úÖ **ssl: S1 ‚Äî batch failure detail** ‚Äî `--batch --check` shows failure reason inline: EXPIRED, DNS FAILURE (NXDOMAIN), CONNECTION REFUSED, TIMEOUT.
- ‚úÖ **ssl: S5 ‚Äî expiry dates in batch output** ‚Äî warnings show "expires in N days (Mon DD, YYYY)"; healthy shows "N days (Mon DD, YYYY)".

### v0.53.0
- ‚úÖ **`--check` grouped output** ‚Äî rules firing ‚â• 10√ó per file collapse to summary + "+N more" note; `--no-group` expands all
- ‚úÖ **Auto-generated file skip** ‚Äî `# reveal: generated` (and common patterns like `# Generated by`) skips files in recursive `--check`
- ‚úÖ **nginx: N006 rule** (HIGH) ‚Äî `send_timeout`/`proxy_read_timeout` < 60s + `client_max_body_size` > 10m; caught real Sociamonials incident

### v0.52.0
- ‚úÖ **nginx: main context directives** ‚Äî `user`, `worker_processes`, `worker_rlimit_nofile`, `error_log`, `pid` now visible in `nginx.conf`; `ssl_protocols`, `ssl_ciphers`, `client_max_body_size` visible in vhost includes
- ‚úÖ **nginx: multi-line directives** ‚Äî `log_format` and other continuation-line directives no longer silently dropped
- ‚úÖ **nginx: upstream backend detail** ‚Äî server entries, `max_fails`, `fail_timeout`, `keepalive` now surfaced per upstream
- ‚úÖ **nginx: map{} block detection** ‚Äî `map $src $target {}` blocks detected and listed (cPanel/WHM pattern)
- ‚úÖ **nginx: N005 rule** ‚Äî flags timeout/buffer directives outside safe operational bounds

### v0.51.1
- ‚úÖ **Cross-platform CI** ‚Äî All 6 matrix jobs pass (Python 3.10/3.12 √ó Ubuntu/macOS/Windows)
- ‚úÖ **Claude adapter two-pass search** ‚Äî TIA-style directory names always checked before UUID filename matches
- ‚úÖ **V009 symlink fix** ‚Äî `normpath` instead of `resolve()` prevents macOS `/var` ‚Üí `/private/var` expansion
- ‚úÖ **Windows path separators** ‚Äî `.as_posix()` in V003 and stats adapter; robust drive-letter parsing in diff adapter
- ‚úÖ **Windows encoding** ‚Äî `encoding='utf-8'` in scaffold write/read; `charmap` errors eliminated
- ‚úÖ **DNS dev dep** ‚Äî `dnspython>=2.0.0` added to dev extras so DNS adapter tests load correctly
- ‚úÖ **chmod tests skipped on Windows** ‚Äî V002/V007/V011/V015/validation tests skip where `chmod(0o000)` is a no-op

### v0.51.0
- ‚úÖ **I002 cache fix** ‚Äî Import graph cache keyed on project root (not file parent); 73-subdir project: 13 min ‚Üí 33s
- ‚úÖ **I002 shared graph across workers** ‚Äî Pre-build once in main process, seed workers via pool initializer; CPU cost 4√ó ‚Üí 1√ó
- ‚úÖ **`--check` parallelism** ‚Äî ProcessPoolExecutor (4 workers); 3,500-file project: 48s ‚Üí 21.5s (2.2√ó)
- ‚úÖ **O(n¬≤) scan eliminated** ‚Äî Rule registry short-circuits correctly; large projects: minutes ‚Üí ~30s
- ‚úÖ **Security hardening** ‚Äî Zip bomb protection, 100 MB file guard, MySQL URL parsing fix, frontmatter eval hardening
- ‚úÖ **claude:// content views** ‚Äî `/user`, `/assistant`, `/thinking`, `/message/<n>` render real content
- ‚úÖ **claude:// search** ‚Äî `?search=term` searches all content including thinking blocks and tool inputs
- ‚úÖ **Bug fixes** ‚Äî ast:// OR logic, `--check` recursive mode, M102/I004 false positives, D001 scoping

### v0.50.0
- ‚úÖ **MySQL table I/O statistics** ‚Äî `mysql:///tables` endpoint for table hotspot detection
- ‚úÖ **Automatic alerts** ‚Äî Extreme read ratios (>10K:1), high volume (>1B reads), long-running (>1h)
- ‚úÖ **Token efficiency** ‚Äî 300-500 tokens vs 2000+ for raw SQL queries
- ‚úÖ **Windows CI fixes** ‚Äî 19 of 22 test failures resolved (86% success rate)
- ‚úÖ **UTF-8 encoding** ‚Äî Cross-platform file handling with explicit encoding

### v0.49.2
- ‚úÖ **Windows CI compatibility** ‚Äî 100% test pass rate on Windows (3177/3177 tests)
- ‚úÖ **Path separator normalization** ‚Äî Cross-platform MANIFEST.in validation
- ‚úÖ **Platform-independent test detection** ‚Äî Use Path.parts for Windows compatibility
- ‚úÖ **Permission test handling** ‚Äî Skip chmod-based tests on Windows

### v0.49.1
- ‚úÖ **Help system badges** ‚Äî Mark xlsx, ssl, and domain as üü° Beta (production-ready)

### v0.49.0
- ‚úÖ **xlsx:// adapter** ‚Äî Complete Excel spreadsheet inspection and data extraction
- ‚úÖ **Sheet extraction** ‚Äî By name (case-insensitive) or 0-based index
- ‚úÖ **Cell range extraction** ‚Äî A1 notation support (A1:Z100, supports AA-ZZ columns)
- ‚úÖ **CSV export** ‚Äî `?format=csv` query parameter for data extraction
- ‚úÖ **40 comprehensive tests** ‚Äî 100% passing, performance tested up to 20K+ rows
- ‚úÖ **Complete documentation** ‚Äî Help system, demo docs, examples

### v0.48.0
- ‚úÖ **Phase 3: Query Operator Standardization** ‚Äî Universal query operators (`=`, `!=`, `>`, `<`, `>=`, `<=`, `~=`, `..`) across all adapters
- ‚úÖ **Phase 4: Field Selection** ‚Äî Token reduction with `--fields`, budget constraints (`--max-items`, `--max-bytes`)
- ‚úÖ **Phase 5: Element Discovery** ‚Äî Auto-discovery of available elements in text and JSON output
- ‚úÖ **Phase 8: Convenience Flags** ‚Äî Ergonomic `--search`, `--sort`, `--type` flags for 80% of within-file queries
- ‚úÖ **Result control** ‚Äî `sort`, `limit`, `offset` work consistently across ast://, json://, markdown://, stats://, git://
- ‚úÖ **Progressive disclosure** ‚Äî `available_elements` enables programmatic element discovery

### v0.47.0
- ‚úÖ **Phase 6: Help Introspection** ‚Äî Machine-readable adapter schemas for all 15 adapters
- ‚úÖ **Phase 7: Output Contract v1.1** ‚Äî Trust metadata (parse_mode, confidence, warnings, errors)
- ‚úÖ **help://schemas/<adapter>** ‚Äî JSON schemas for AI agent auto-discovery
- ‚úÖ **help://examples/<task>** ‚Äî Canonical query recipes for common tasks

### v0.45.0
- ‚úÖ **Phase 1: Universal Operation Flags** ‚Äî `--advanced`, `--only-failures` across all adapters
- ‚úÖ **Phase 2: Stdin Batch Processing** ‚Äî Universal `--batch` flag with result aggregation
- ‚úÖ **Batch mode** ‚Äî Works with any adapter, mixed adapter batches supported
- ‚úÖ **Format consistency** ‚Äî All 18 adapters support `--format json|text`

### v0.44.2
- ‚úÖ **SSL certificate parsing fix** ‚Äî TLS 1.3 connections properly handled (cryptography dependency)
- ‚úÖ **52 SSL tests passing** ‚Äî Comprehensive test coverage

### v0.44.1
- ‚úÖ **Batch SSL filter flags** ‚Äî `--only-failures`, `--summary`, `--expiring-within` work with `--stdin --check`
- ‚úÖ **Issue #19 resolved** ‚Äî Composable SSL batch checks fully functional

### v0.44.0
- ‚úÖ **`--extract` flag** ‚Äî Extract structured data for composable pipelines
- ‚úÖ **domain:// adapter** ‚Äî Domain registration, DNS records, health status inspection

### v0.43.0
- ‚úÖ **`@file` batch syntax** ‚Äî Read targets from a file (`reveal @domains.txt --check`)
- ‚úÖ **`ssl://nginx:///` integration** ‚Äî Extract and check SSL domains from nginx configs
- ‚úÖ **Batch SSL filters** ‚Äî `--only-failures`, `--summary`, `--expiring-within N`
- ‚úÖ **Validation rule fixes** ‚Äî V004/V007/V011 skip non-dev installs (no false positives)

### v0.42.0
- ‚úÖ **Universal `--stdin` URI support** ‚Äî Batch processing works with any URI scheme (ssl://, claude://, env://)
- ‚úÖ **Query parsing utilities** ‚Äî New `reveal/utils/query.py` for adapter authors
- ‚úÖ **SSL batch workflows** ‚Äî Check multiple certificates via stdin pipeline
- ‚úÖ **Nginx+SSL integration docs** ‚Äî Comprehensive AGENT_HELP.md coverage

### v0.41.0
- ‚úÖ **`ssl://` adapter** ‚Äî SSL/TLS certificate inspection (zero dependencies)
- ‚úÖ **N004 rule** ‚Äî ACME challenge path inconsistency detection
- ‚úÖ **Content-based nginx detection** ‚Äî `.conf` files detected by content, not path
- ‚úÖ **Enhanced nginx display** ‚Äî Server ports `[443 (SSL)]`, location targets

### v0.40.0
- ‚úÖ **`--dir-limit` flag** ‚Äî Per-directory entry limit (solves node_modules problem)
- ‚úÖ **`--adapters` flag** ‚Äî List all URI adapters with descriptions
- ‚úÖ **M104 rule** ‚Äî Hardcoded list detection for maintainability
- ‚úÖ **ROADMAP.md** ‚Äî Public roadmap for contributors
- ‚úÖ **Breadcrumb improvements** ‚Äî Extraction hints for 25+ file types

### v0.33 - v0.39

#### Language Support
- ‚úÖ **Kotlin, Swift, Dart** ‚Äî Mobile development platforms
- ‚úÖ **Zig** ‚Äî Systems programming
- ‚úÖ **Terraform/HCL** ‚Äî Infrastructure-as-code
- ‚úÖ **GraphQL** ‚Äî API schemas
- ‚úÖ **Protocol Buffers** ‚Äî gRPC serialization
- ‚úÖ **CSV/Excel** ‚Äî Tabular data analysis

#### Adapters
- ‚úÖ **sqlite://** ‚Äî SQLite database inspection
- ‚úÖ **git://** ‚Äî Repository history and blame analysis
- ‚úÖ **imports://** ‚Äî Dependency analysis with circular detection

#### Quality & Developer Experience
- ‚úÖ **Output Contract** ‚Äî Stable, documented output formats
- ‚úÖ **Stability Taxonomy** ‚Äî Clear API stability guarantees
- ‚úÖ **Workflow Recipes** ‚Äî Common usage patterns documented

---

## Current Focus: Path to v1.0

### Test Coverage & Quality
- Test count: 4,546 passing (as of v0.54.3)
- UX Phases 3/4/5: ‚úÖ **ALL COMPLETE** (query operators, field selection, element discovery)
- Target: 80%+ coverage for core adapters

### Stability & Polish
- Output contract v1.1 enforcement
- Performance optimization for large codebases
- `autossl://` adapter ‚Äî parse `/var/cpanel/logs/autossl/TIMESTAMP/` per-domain outcomes
- `--full-audit` ‚Äî `reveal cpanel://USERNAME --full-audit` composing ssl+acl+nginx in one pass
- U6 follow-on ‚Äî IP-match verification (resolves but to different server)

---

## Post-v1.0 Features

> **Status**: Strategic backlog. Not prioritized for implementation yet.
> See `internal-docs/design/SUBCOMMANDS_DESIGN.md` for the full design.

### Subcommands (Intent-Based Workflows)

Reveal's URI model (`reveal <path|uri> [flags]`) is powerful for resource exploration. Subcommands address a complementary need: encoding *user intent* as first-class CLI verbs that orchestrate multiple adapters into unified workflows.

**Design principle**: URIs explore resources. Subcommands accomplish goals.

#### Tier 1 (Highest Value)

**`reveal check`** ‚Äî formalize the existing `--check` flag as a proper subcommand
```bash
reveal check ./src
reveal check ./src --select=B,S --only-failures
```
Low effort, high ergonomics gain. Makes linting discoverable in `reveal --help`.

---

**`reveal review`** ‚Äî code review workflow for PRs and health checks
```bash
reveal review ./src                  # Health + quality review
reveal review main..feature          # PR structural diff + quality
reveal review main..feature --format json  # CI/CD gate (exit codes)
```
Orchestrates: `diff://`, `stats://`, `ast://`, `imports://`, `--check`. Five commands today; one command tomorrow.

---

**`reveal pack`** ‚Äî curated, token-budgeted context for LLM consumption
```bash
reveal pack ./src --budget 2000-tokens
reveal pack ./api --budget 500-lines
```
Formalizes "give me enough context but not too much." Critical for agentic workflows.

---

**`reveal health`** ‚Äî unified health check across any resource type
```bash
reveal health ./src                  # Code quality health
reveal health ssl://example.com      # SSL cert health
reveal health mysql://prod/db        # DB health
```
Consistent pass/warn/fail model with exit codes for CI/CD monitoring.

---

**`reveal dev`** ‚Äî developer tooling namespace
```bash
reveal dev new-adapter payments --uri pay
reveal dev new-rule R914 "deep nesting"
reveal dev inspect-config
```
Wraps the planned scaffold commands + config introspection into a coherent namespace.

#### Tier 2 (Post-v1.0)

```bash
reveal overview              # Auto-generated repo summary
reveal hotspots              # Complexity/quality issues (top N files/functions)
reveal onboarding            # First-day guide for unfamiliar codebases
reveal audit                 # Security/compliance focus (S, B, N rules)
reveal deps                  # Full dependency analysis (wraps imports://)
```

### Relationship Queries (Call Graphs)
```bash
reveal calls://src/api.py:handle_request  # Who calls this?
reveal depends://src/module/              # What depends on this?
```
**Why valuable**: Structure tells you what exists; relationships tell you what *matters*.

**Current limitation**: Requires cross-file static analysis. Tree-sitter infrastructure is ready, but call resolution is non-trivial.

### Git-Aware Defaults
```bash
reveal .                    # Defaults to changed files on branch
reveal --since HEAD~3       # Changes since commit
reveal --pr                 # PR context auto-detection
```
**Why valuable**: Makes tool instantly relevant to daily workflows.

---

---

## Lower Priority / Speculative

| Feature | Notes |
|---------|-------|
| PostgreSQL adapter | mysql:// proves pattern; diminishing returns |
| Docker adapter | `docker inspect` already exists |
| LSP integration | Big effort; IDEs have good tools |
| --watch mode | Nice UX but not core; use `watch reveal file.py` |

---

## Explicitly Not Planned

These violate reveal's mission ("reveal reveals, doesn't modify") or have unclear value:

| Feature | Why Not |
|---------|---------|
| `--fix` auto-fix | Mission violation. Use Ruff/Black for formatting/fixes. |
| `semantic://` embedding search | Requires ML infrastructure; over-engineered |
| `trace://` execution traces | Wrong domain (debugging tools) |
| `live://` real-time monitoring | Wrong domain (observability tools) |
| Parquet/Arrow | Binary formats, not human-readable. Use pandas. |

---

## Language Support Status

**Current**: 31 built-in analyzers + 165+ via tree-sitter fallback

### Production-Ready
Python, JavaScript, TypeScript, Rust, Go, Java, C, C++, C#, Ruby, PHP, Kotlin, Swift, Dart, Zig, Scala, Lua, GDScript, Bash, SQL

### Config & Data
Nginx, Dockerfile, TOML, YAML, JSON, JSONL, Markdown, HTML, CSV, XML, INI, HCL/Terraform, GraphQL, Protobuf

### Office Formats
Excel (.xlsx), Word (.docx), PowerPoint (.pptx), LibreOffice (ODF)

### Tree-Sitter Fallback
165+ additional languages with basic structure extraction: Perl, R, Haskell, Elixir, OCaml, and more.

---

## Adapter Status

### Implemented (16)
| Adapter | Description |
|---------|-------------|
| `ast://` | Query code as database (complexity, size, type filters) |
| `claude://` | Claude conversation analysis |
| `diff://` | Compare files or git revisions |
| `domain://` | Domain registration, DNS records, health status |
| `env://` | Environment variable inspection |
| `git://` | Repository history, blame, commits |
| `help://` | Built-in documentation |
| `imports://` | Dependency analysis, circular detection |
| `json://` | JSON/JSONL deep inspection |
| `mysql://` | MySQL database schema inspection |
| `python://` | Python runtime inspection |
| `reveal://` | Reveal's own codebase |
| `sqlite://` | SQLite database inspection |
| `ssl://` | SSL/TLS certificate inspection |
| `stats://` | Codebase statistics |

### Planned
| Adapter | Notes |
|---------|-------|
| `nginx://` | Nginx config structured querying (Tier 3) |
| `calls://` | Call graph analysis (post-v1.0) |

---

## Contributing

See [CONTRIBUTING.md](CONTRIBUTING.md) for how to add analyzers, adapters, or rules.

**Good first contributions:**
- Language analyzer improvements
- Pattern detection rules
- Documentation and examples
